import { PRECOMPILE_GMP_ADDRESS } from "../../util/constants";
import { expectEVMResult } from "../../util/eth-transactions";
import { describeDevMoonbeam } from "../../util/setup-dev-tests";
import { createTransaction } from "../../util/transactions";

describeDevMoonbeam(`Test exisiting Wormhole Payload Precompile VAA`, (context) => {
  it.only("should send transaction", async function () {
    this.timeout(3600 * 1000);

    const data =
      "0xf53774ab01000000000100d98b0684017cffa1a56f77f3408d570809c440b533b8c3ef2b259b44cbf93105352d11ab862e7c33fec4e54d3ef10d5c8928c5c3b3de15bcb1d5d92db66a92f901640b665d00000001000a000000000000000000000000599cea2204b4faecd584ab1f2b6aca137a0afbe8000000000000009e01030000000000000000000000000000000000000000000000000000000001312d00000000000000000000000000f1277d1ed8ad466beddf92ef448a132661956621000a00000000000000000000000000000000000000000000000000000000000008150010000000000000000000000000b7e8c35609ca73277b2207d07b51c9ac5798b380000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000807b2022706172656e7473223a20312c2022696e746572696f72223a207b20225832223a205b207b202250617261636861696e223a20383838207d2c207b20224163636f756e744b65793230223a202230783335344231304434376538344130303662394537653636413232394431373445384646324130363322207d205d7d7d";

    const result = await context.createBlock(
      createTransaction(context, {
        to: PRECOMPILE_GMP_ADDRESS,
        gas: 500_000,
        data,
      })
    );

    expectEVMResult(result.result.events, "Succeed", "Stopped");
  });
});
